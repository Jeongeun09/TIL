AOP란?
==== 
관점 지향 프로그래밍이다.

공통 기능과 부가 기능을 나누고 공통 기능을 모듈화하여 핵심 로직에 자동으로 붙여주는 기술이다.  

일반적으로 사용하는 프로그래밍에는 여러 가지 기술들이 들어가야 한다. 여기에는 예외 처리, 권한 체크 같은 것들이 들어가야 하는데 이 코드들이 다른 클래스에서도 \계속 반복되는 현상이 일어나게 된다.
이럴 경우에는 유지 보수가 힘들고 가독성이 떨어지게 된다. 이럴 때 AOP를 사용한다.

---

## AOP 용어

핵심 기능(Primary Concern)
→ 진짜 하고 싶은 로직을 말한다.

부가 기능(Cross-cutting Concern)
→ 여러 곳에서 반복되어 공통적으로 실행되는 기능을 말한다.

Aspect
→ 부가 기능을 담을 수 있는 단위라고 생각하면 된다.

Advice
→ 부가 기능을 언제 실행할 것인 지에 대해서 결정하는 역할을 하는 코드들을 말한다.

Pointcut
→ 부가 기능이 실행될 때 어떤 메서드를 사용할 지에 대해 결정하는 역할을 하는 코드들을 말한다.

Weaving
→ 부가 기능을 핵심 기능에 실제로 적용시키는 과정을 말한다.

---


### AOP의 장단점
 
<장점>

관심사의 분리
→ 핵심과 부가 기능을 분리하여 핵심 코드가 보기에 더 깔끔하고 코드 작성 의도를 더 잘 나타낼 수 있게 된다.

중복 코드 제거
→ 여러 개의 클래스에서 반복되는 코드들을 공통 Aspect로 묶어 재사용이 가능하다.

유지 보수 용이
→ 부가 기능을 수정, 제거 할 때 핵심 코드를 손보지 않고 Aspect 클래스만 수정하여 편리하다.

새로운 부가 기능 추가 편리
→ 기능을 추가할 때 훨씬 간편하게 코드를 작성할 수 있다.


<단점>

흐름이 복잡하다.
→ 코드에 안 보이는 부분이 실행되기 때문에 코드만 보았을 때 어떤 식으로 동작하는 지 흐름을 파악하기 어렵다.

과다 사용 불가
→ 모든 부가 기능들을 AOP로 사용하게 되면 코드의 흐름이 흩어지게 되면서 코드를 보고 파악이 불가하다.

디버깅 힘들다.
→ 실제 어떤 Aspect가 사용되는 지 실행중에만 알 수 있어 디버깅에 어려움이 있다.


---


AOP가 아닌 기본 구조
: 핵심 기능과 부가 기능에 대해서 분리가 이루어져 있지 않고 핵심 으로 섞여 있다. 
그렇기 때문에 관심사의 분리가 되지 않기 때문에 코드가 복잡해지고 코드의 의도가 전달되지 않아 유지보수에 어려움을 생길 수 있다.


AOP 구조
: 핵심 기능과 부가 기능을 서로 분리가 되어있기 때문에 핵심 코드에 부가 코드가 반복적으로 들어가지 않는다. 
반복적인 부분이 핵심 코드에 들어가지 않기 때문에 핵심 코드 의도 파악이 쉽다. 
그렇기 때문에 부가 기능에 대해서 수정하거나 삭제, 추가할 때에 편리하게 이용이 가능하다. 



부가 기능이 핵심 기능보다 먼저 실행되는 이유?

부가 기능에는 대표적으로 유효성 검사, 인증과 로깅 같은 사전 작업들이 있다. 
그렇기 때문에 핵심 기능을 실행하기 전 사전 작업들을 진행해야 하기 때문에 부가 기능이 핵심 기능보다 먼저 실행된다

---

## AOP의 구현 방식
AOP를 구현할 수 있는 방법으로는 2가지가 있다. 하나는 프록시 기반, 다른 하나는 바이트 코드 기반이다. 

 

#### 프록시 기반 방식
Spring AOP

프록시 객체를 만들어서 AOP 기능을 적용한다.

spring AOP는 런타임 시에만 동작이 가능하다. 왜냐하면 프록시는 실행 중일 때에만 생성되어야 하기 때문에 Spring AOP는 런타임 시에만 동작한다.

또한 주로 메서드 단위로 동작한다. 

프록시 객체란?

: 소프트웨어에서 다른 객체를 대신하 그 객체에 대해서 접근 제어 또는 기능 확장을 한다.

> 장단점

장점 - 스프링 설정만으로 간단하게 사용이 가능하다.

단점 - 메서드 단위로만 실행되기 때문에 클래스 전체, 필드 단위로는 어려움이 있다.

 
#### 바이트 코드 조작 방식
AspectJ AOP

컴파일 할 때 또는 클래스 로딩 시점에서 AOP 기능을 코드에 직접 끼워 넣는 방식이다.

프록시 기반 AOP보다 훨씬 정밀한 AOP 구현이 가능하다.

메서드, 클래스 전체, 필드 등등 많은 부분에 AOP를 적용시킬 수 있다. 

> 장단점

장점 - 모든 객체에 AOP를 적용시킬 수 있다.

단점 - Spring AOP처럼 스프링 설정만으로 간단하게 사용이 불가능하고 설정이 복잡하다. AspectJ 컴파일러가 필요하다.


